---
import { Image } from "astro:assets";
import type { CollectionEntry } from "astro:content";
import readingTime from "reading-time";

interface Props {
  post: CollectionEntry<"posts">;
  index: number;
}

const { post, index } = Astro.props;
const stats = readingTime(post.body);
---

<div class="block group post-item relative">
    <article class="post-article flex flex-col sm:flex-row gap-6 items-start transition-all duration-300">
        {post.data.image && (
            <div class="post-image-wrapper w-full sm:w-48 h-48 sm:h-40 overflow-hidden rounded-lg bg-stone-200 shrink-0 transition-all duration-300">
                <Image
                    src={post.data.image}
                    alt=""
                    class="w-full h-full object-cover transition transform group-hover:scale-105 duration-500"
                    loading={index < 4 ? "eager" : "lazy"}
                />
            </div>
        )}
        <div class="post-content flex flex-col flex-grow">
            <a href={`/posts/${post.slug}`} class="block">
                <h2 class="text-2xl font-serif font-medium group-hover:text-stone-600 transition-colors">
                    {post.data.title}
                </h2>
            </a>
            
            <div class="mt-1 mb-3 flex items-center gap-2">
                <span class="text-stone-400 text-sm font-sans">
                    {post.data.pubDate.toLocaleDateString(
                        "en-US",
                        {
                            year: "numeric",
                            month: "long",
                            day: "numeric",
                        },
                    )}
                </span>
                <span class="text-stone-300 text-xs">â€¢</span>
                <span class="text-stone-400 text-sm font-sans">
                    {stats.text}
                </span>
            </div>

            <a href={`/posts/${post.slug}`} class="block">
                <p class="text-stone-600 leading-relaxed">
                    {post.data.description}
                </p>
            </a>
        </div>
        {/* Full card link overlay */}
        <a href={`/posts/${post.slug}`} class="absolute inset-0 z-0" aria-label={`Read ${post.data.title}`}></a>
    </article>
</div>

